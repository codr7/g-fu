(let switch (mac (alts..)
  (fold (reverse alts)
        (fun (acc alt)
          '(if %(head alt)
             (do %(tail alt)..)
             %acc))
        _)))